# NetAssist 测试指南

本文档提供使用 NetAssist 网络调试助手验证 UDP 服务端/客户端流程的详细步骤和报文数据。

## 1. 测试环境准备

1.  **启动 Java 应用程序**
    - 该程序将监听本地 UDP 端口 **19210** (接收响应)。
    - 该程序将向本地 UDP 端口 **19211** 发送请求。

2.  **配置 NetAssist (模拟服务端)**
    - **协议类型**: UDP
    - **本地主机地址**: 127.0.0.1
    - **本地主机端口**: **19211** (接收 Java 端的请求)
    - **远程主机地址**: 127.0.0.1
    - **远程主机端口**: **19210** (发送响应给 Java 端)
    - **设置**: 勾选 "按十六进制显示" 和 "按十六进制发送"。

## 2. 测试流程

### 步骤 1: 触发 Java 端发送请求

你需要通过 WebSocket 或其他方式触发 Java 端发送请求。假设你发送的请求 RequestID 为 `1001` (0x03E9)。

一旦触发，你应该在 NetAssist 的接收区看到类似以下的数据：

**客户端请求报文 (RequestID = 1001):**
```text
01 00 E9 03 00 00 00 00 00 00 00 00 9A 99 99 99 99 19 5D 40 33 33 33 33 33 F3 43 40 0A D7 A3 70 3D 1A 5D 40 14 AE 47 E1 7A F4 43 40 01 00
```

- `01 00`: 消息类型 (TerrainRequest)
- `E9 03 00 00 00 00 00 00`: RequestID (1001)
- 后续为经纬度等数据。

### 步骤 2: 发送模拟响应

在 NetAssist 的发送区，填入以下十六进制字符串并点击发送。这将模拟服务端返回给客户端的响应。

**服务端响应报文 (RequestID = 1001, 含分片头):**
```text
9F 86 01 00 01 00 00 00 49 00 00 00 00 00 00 01 00 E9 03 00 00 00 00 00 00 02 00 00 00 9A 99 99 99 99 19 5D 40 0A D7 A3 70 3D 1A 5D 40 01 00 00 00 00 00 00 3F 0A 00 00 00 52 B8 1E 85 EB 19 5D 40 C3 F5 28 5C 8F 1A 5D 40 02 00 00 00 CD CC 4C 3F 14 00 03 00 A1 B2 C3
```

**报文解析:**

1.  **分片头 (15字节)**: `9F 86 01 00` ... `00 00 00`
    - `9F 86 01 00`: SessionID (随机)
    - `01 00`: 总包数 (1)
    - `00 00`: 当前包序号 (0)
    - `49 00`: 数据长度 (73字节)
    - `00 00 00 00 00`: 标志位和校验和

2.  **响应体 (TerrainResponse)**:
    - `01 00`: Type (1)
    - `E9 03 00 00 00 00 00 00`: RequestID (1001) - **必须与请求匹配**
    - `02 00 00 00`: Count (2个点)
    
3.  **数据项 (ResponseItem 1)**:
    - `9A 99 99 99 99 19 5D 40`: A经度 (116.40)
    - ...
    - `00 00`: 地形数据长度 (0)

4.  **数据项 (ResponseItem 2)**:
    - ...
    - `03 00`: 地形数据长度 (3)
    - `A1 B2 C3`: 地形数据

### 步骤 3: 验证结果

Java 应用程序收到该报文后，控制台日志应显示类似：
`Received UDP response: requestId=1001, count=2`

且对应的 WebSocket 连接应收到 JSON 格式的响应数据。
